"undefined"==typeof XML&&(XML=function(){}),XML.ObjTree=function(){return this},XML.ObjTree.VERSION="0.24",XML.ObjTree.prototype.xmlDecl='<?xml version="1.0" encoding="UTF-8" ?>\n',XML.ObjTree.prototype.attr_prefix="-",XML.ObjTree.prototype.overrideMimeType="text/xml",XML.ObjTree.prototype.parseXML=function(e){var t;if(window.DOMParser){var r=new DOMParser,n=r.parseFromString(e,"application/xml");if(!n)return;t=n.documentElement}else window.ActiveXObject&&((r=new ActiveXObject("Microsoft.XMLDOM")).async=!1,r.loadXML(e),t=r.documentElement);if(t)return this.parseDOM(t)},XML.ObjTree.prototype.parseHTTP=function(e,t,r){var n,a={};for(var o in t)a[o]=t[o];if(a.method||(void 0===a.postBody&&void 0===a.postbody&&void 0===a.parameters?a.method="get":a.method="post"),r){a.asynchronous=!0;var i=this,l=r,s=a.onComplete;a.onComplete=function(e){var t;e&&e.responseXML&&e.responseXML.documentElement?t=i.parseDOM(e.responseXML.documentElement):e&&e.responseText&&(t=i.parseXML(e.responseText)),l(t,e),s&&s(e)}}else a.asynchronous=!1;if("undefined"!=typeof HTTP&&HTTP.Request)a.uri=e,(c=new HTTP.Request(a))&&(n=c.transport);else if("undefined"!=typeof Ajax&&Ajax.Request){var c;(c=new Ajax.Request(e,a))&&(n=c.transport)}return r?n:n&&n.responseXML&&n.responseXML.documentElement?this.parseDOM(n.responseXML.documentElement):n&&n.responseText?this.parseXML(n.responseText):void 0},XML.ObjTree.prototype.parseDOM=function(e){if(e){if(this.__force_array={},this.force_array)for(var t=0;t<this.force_array.length;t++)this.__force_array[this.force_array[t]]=1;var r=this.parseElement(e);if(this.__force_array[e.nodeName]&&(r=[r]),11!=e.nodeType){var n={};n[e.nodeName]=r,r=n}return r}},XML.ObjTree.prototype.parseElement=function(e){if(7!=e.nodeType){if(3==e.nodeType||4==e.nodeType){if(null==e.nodeValue.match(/[^\x00-\x20]/))return;return e.nodeValue}var t,r={};if(e.attributes&&e.attributes.length){t={};for(var n=0;n<e.attributes.length;n++){if("string"==typeof(i=e.attributes[n].nodeName))(l=e.attributes[n].nodeValue)&&(void 0===r[i=this.attr_prefix+i]&&(r[i]=0),r[i]++,this.addNode(t,i,r[i],l))}}if(e.childNodes&&e.childNodes.length){var a=!0;t&&(a=!1);for(n=0;n<e.childNodes.length&&a;n++){var o=e.childNodes[n].nodeType;3!=o&&4!=o&&(a=!1)}if(a){t||(t="");for(n=0;n<e.childNodes.length;n++)t+=e.childNodes[n].nodeValue}else{t||(t={});for(n=0;n<e.childNodes.length;n++){var i,l;if("string"==typeof(i=e.childNodes[n].nodeName))(l=this.parseElement(e.childNodes[n]))&&(void 0===r[i]&&(r[i]=0),r[i]++,this.addNode(t,i,r[i],l))}}}return t}},XML.ObjTree.prototype.addNode=function(e,t,r,n){this.__force_array[t]?(1==r&&(e[t]=[]),e[t][e[t].length]=n):1==r?e[t]=n:2==r?e[t]=[e[t],n]:e[t][e[t].length]=n},XML.ObjTree.prototype.writeXML=function(e){var t=this.hash_to_xml(null,e);return this.xmlDecl+t},XML.ObjTree.prototype.hash_to_xml=function(e,t){var r=[],n=[];for(var a in t)if(t.hasOwnProperty(a)){var o=t[a];a.charAt(0)!=this.attr_prefix?void 0===o||null==o?r[r.length]="<"+a+" />":"object"==typeof o&&o.constructor==Array?r[r.length]=this.array_to_xml(a,o):r[r.length]="object"==typeof o?this.hash_to_xml(a,o):this.scalar_to_xml(a,o):n[n.length]=" "+a.substring(1)+'="'+this.xml_escape(o)+'"'}var i=n.join(""),l=r.join("");return void 0===e||null==e||(l=r.length>0?l.match(/\n/)?"<"+e+i+">\n"+l+"</"+e+">\n":"<"+e+i+">"+l+"</"+e+">\n":"<"+e+i+" />\n"),l},XML.ObjTree.prototype.array_to_xml=function(e,t){for(var r=[],n=0;n<t.length;n++){var a=t[n];void 0===a||null==a?r[r.length]="<"+e+" />":"object"==typeof a&&a.constructor==Array?r[r.length]=this.array_to_xml(e,a):r[r.length]="object"==typeof a?this.hash_to_xml(e,a):this.scalar_to_xml(e,a)}return r.join("")},XML.ObjTree.prototype.scalar_to_xml=function(e,t){return"#text"==e?this.xml_escape(t):"<"+e+">"+this.xml_escape(t)+"</"+e+">\n"},XML.ObjTree.prototype.xml_escape=function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},function(){function e(e){var t="    ";if(isNaN(parseInt(e)))t=e;else switch(e){case 1:t=" ";break;case 2:t="  ";break;case 3:t="   ";break;case 4:t="    ";break;case 5:t="     ";break;case 6:t="      ";break;case 7:t="       ";break;case 8:t="        ";break;case 9:t="         ";break;case 10:t="          ";break;case 11:t="           ";break;case 12:t="            "}var r=["\n"];for(ix=0;ix<100;ix++)r.push(r[ix]+t);return r}function t(){this.step="    ",this.shift=e(this.step)}function r(e,t){return t-(e.replace(/\(/g,"").length-e.replace(/\)/g,"").length)}function n(e,t){return e.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+t+t+"AND ").replace(/ BETWEEN /gi,"~::~"+t+"BETWEEN ").replace(/ CASE /gi,"~::~"+t+"CASE ").replace(/ ELSE /gi,"~::~"+t+"ELSE ").replace(/ END /gi,"~::~"+t+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+t+"ON ").replace(/ OR /gi,"~::~"+t+t+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+t+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+t).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+t+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}t.prototype.xml=function(t,r){var n=t.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),a=n.length,o=!1,i=0,l="",s=0,c=r?e(r):this.shift;for(s=0;s<a;s++)n[s].search(/<!/)>-1?(l+=c[i]+n[s],o=!0,(n[s].search(/-->/)>-1||n[s].search(/\]>/)>-1||n[s].search(/!DOCTYPE/)>-1)&&(o=!1)):n[s].search(/-->/)>-1||n[s].search(/\]>/)>-1?(l+=n[s],o=!1):/^<\w/.exec(n[s-1])&&/^<\/\w/.exec(n[s])&&/^<[\w:\-\.\,]+/.exec(n[s-1])==/^<\/[\w:\-\.\,]+/.exec(n[s])[0].replace("/","")?(l+=n[s],o||i--):n[s].search(/<\w/)>-1&&-1==n[s].search(/<\//)&&-1==n[s].search(/\/>/)?l=l+=o?n[s]:c[i++]+n[s]:n[s].search(/<\w/)>-1&&n[s].search(/<\//)>-1?l=l+=o?n[s]:c[i]+n[s]:n[s].search(/<\//)>-1?l=l+=o?n[s]:c[--i]+n[s]:n[s].search(/\/>/)>-1?l=l+=o?n[s]:c[i]+n[s]:n[s].search(/<\?/)>-1||n[s].search(/xmlns\:/)>-1||n[s].search(/xmlns\=/)>-1?l+=c[i]+n[s]:l+=n[s];return"\n"==l[0]?l.slice(1):l},t.prototype.json=function(e,t){t=t||this.step;return"undefined"==typeof JSON?e:"string"==typeof e?JSON.stringify(JSON.parse(e),null,t):"object"==typeof e?JSON.stringify(e,null,t):e},t.prototype.css=function(t,r){var n=t.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),a=n.length,o=0,i="",l=0,s=r?e(r):this.shift;for(l=0;l<a;l++)/\{/.exec(n[l])?i+=s[o++]+n[l]:/\}/.exec(n[l])?i+=s[--o]+n[l]:(/\*\\/.exec(n[l]),i+=s[o]+n[l]);return i.replace(/^\n{1,}/,"")},t.prototype.sql=function(t,a){var o=t.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),i=o.length,l=[],s=0,c=this.step,p=0,u="",f=0,d=a?e(a):this.shift;for(f=0;f<i;f++)l=f%2?l.concat(o[f]):l.concat(n(o[f],c));for(i=l.length,f=0;f<i;f++){p=r(l[f],p),/\s{0,}\s{0,}SELECT\s{0,}/.exec(l[f])&&(l[f]=l[f].replace(/\,/g,",\n"+c+c)),/\s{0,}\s{0,}SET\s{0,}/.exec(l[f])&&(l[f]=l[f].replace(/\,/g,",\n"+c+c)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(l[f])?u+=d[++s]+l[f]:/\'/.exec(l[f])?(p<1&&s&&s--,u+=l[f]):(u+=d[s]+l[f],p<1&&s&&s--)}return u=u.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},t.prototype.xmlmin=function(e,t){return(t?e:e.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},t.prototype.jsonmin=function(e){return"undefined"==typeof JSON?e:JSON.stringify(JSON.parse(e),null,0)},t.prototype.cssmin=function(e,t){return(t?e:e.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},t.prototype.sqlmin=function(e){return e.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},window.vkbeautify=new t}(),function(e,t){"function"==typeof define&&define.amd?define(["exports"],(function(r){t(e,r)})):"undefined"!=typeof exports?t(e,exports):t(e,e.fd=e.fd||{})}(this,(function(t,r){r.randomID=function(e){return(e||"fd")+"_"+(1e4*Math.random()).toFixed()},r.uniqueID=function(e){do{var t=r.randomID(e)}while(r.byID(t));return t},r.byID=function(e){return r.isTag(e)?e:document.getElementById(e)},r.isTag=function(e,t){return"object"==typeof e&&e&&1==e.nodeType&&(!t||e.tagName.toUpperCase()==t.toUpperCase())},r.newXHR=function(){try{return new XMLHttpRequest}catch(r){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.5.0","MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],t=0;t<e.length;t++)try{return new ActiveXObject(e[t])}catch(e){}}throw"Cannot create XMLHttpRequest."},r.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},r.toArray=function(e,t){return null==e?[]:(!r.isArray(e)&&("object"!=typeof e||!("callee"in e))&&(e=[e]),Array.prototype.slice.call(e,t||0))},r.addEvent=function(e,t,r){return e&&t&&r&&(e.attachEvent?(e["e"+t+r]=r,e[t+r]=function(){e["e"+t+r](window.event)},e.attachEvent("on"+t,e[t+r])):e.addEventListener(t,r,!1)),e},r.stopEvent=function(e){return e.cancelBubble=!0,e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),e},r.setClass=function(e,t,n){return(e=r.byID(e))&&null!=t&&(void 0===n||n?r.hasClass(e,t)||(e.className+=" "+t):e.className=e.className.replace(r.classRegExp(t)," ")),e},r.hasClass=function(e,t){return r.classRegExp(t).test((r.byID(e)||{}).className)},r.classRegExp=function(e){return""==e||"object"==typeof e?/$o_O/:new RegExp("(^|\\s+)"+e+"(\\s+|$)","gi")},r.extend=function(e,t,r){for(var n in e=e||{},t=t||{})(r||void 0===e[n])&&(e[n]=t[n]);return e},r.callAll=function(e,t,n){var a;if(t=r.toArray(t),"function"==typeof e&&(e=[e]),r.isArray(e))for(var o=0;o<e.length&&("function"!=typeof e[o]||null==(a=e[o].apply(n||this,t)));o++);else if(e)throw"FileDrop event list must be either an Array, Function, undefined or null but "+typeof e+" was given.";return a},r.callAllOfObject=function(e,t,n){if(r.logging&&r.hasConsole){var a=e.events[t]&&e.events[t].length||0;console.info("FileDrop "+t+" event ("+a+") args:"),console.dir([n])}var o=[r.onObjectCall].concat(e.events.any),i=r.callAll(o,[t].concat(r.toArray(n)),e);return null!=i?i:r.callAll(e.events[t],n,e)},r.appendEventsToObject=function(e,t){if(r.addEventsToObject(this,!1,arguments))return this;switch(arguments.length){case 0:return r.extend({},this.events);case 1:if(null===e)return this.events={},this;if(r.isArray(e)){for(var n={},a=0;a<e.length;a++)n[e[a]]=r.toArray(this.events[e[a]]);return n}if("function"==typeof e)return r.funcNS(e);if("string"==typeof e)return r.toArray(this.events[e]);case 2:if(e=r.toArray(e),null===t){for(a=0;a<e.length;a++){var o=r.splitNS(e[a]);if(o[0])if(o[1]){if(this.events[o[0]])for(var i=this.events[o[0]].length-1;i>=0;i--)r.funcNS(this.events[o[0]][i])==o[1]&&this.events[o[0]].splice(i,1)}else this.events[o[0]]=[];else for(var l in this.events)arguments.callee.call(this,[l+":"+o[1]],null)}return this}}throw"Bad parameters for FileDrop event()."},r.previewToObject=function(e,t){if(r.addEventsToObject(this,!0,arguments))return this;throw"Bad parameters for FileDrop preview()."},r.addEventsToObject=function(e,t,n){var a=n[0],o=n[1];switch(n.length){case 1:if(a&&"object"==typeof a&&!r.isArray(a)){for(var i in a)arguments.callee(e,t,[i,a[i]]);return!0}case 2:if("function"==typeof o||r.isArray(o)){a=r.toArray(a),o=r.toArray(o);for(var l=t?"unshift":"push",s=0;s<a.length;s++){for(var c=r.splitNS(a[s]),p=0;p<o.length;p++)r.funcNS(o[p],c[1]);e.events[c[0]]=e.events[c[0]]||[],e.events[c[0]][l].apply(e.events[c[0]],o)}return!0}}},r.funcNS=function(e,t){return"function"!=typeof e?e:1==arguments.length?(e[r.nsProp]||"").toString():(e[r.nsProp]=(t||"").toString(),e)},r.splitNS=function(e){return(e||"").match(/^([^:]*):?(.*)$/).slice(1)},r.extend(r,{logging:!0,hasConsole:"console"in window&&console.log&&console.dir,onObjectCall:null,all:[],isIE6:!1,isIE9:!1,isChrome:-1!=(navigator.vendor||"").indexOf("Google"),nsProp:"_fdns"}),r.DropHandle=function(e,t){var n=this;if(n.el=e=r.byID(e),!e)throw"Cannot locate DOM node given to new FileDrop class.";n.opt={zoneClass:"fd-zone",inputClass:"fd-file",iframe:{url:"",callbackParam:"fd-callback",fileParam:"fd-file"},input:null,recreateInput:!0,fullDocDragDetect:!1,multiple:!1,dropEffect:"copy"},r.all.push(n),n.filedrop=null;var a=n.opt.iframe;r.extend(n.opt,t,!0),r.extend(n.opt.iframe,a),r.isChrome&&(n.opt.fullDocDragDetect=!0),n.events={any:[],dragEnter:[],dragLeave:[],dragOver:[],dragEnd:[],dragExit:[],upload:[],uploadElsewhere:[],inputSetup:[],iframeSetup:[],iframeDone:[]},n.on=n.events,n.zone=n.el,n.hook=function(e){0!=n.opt.input&&(n.opt.input=n.opt.input||n.prepareInput(e),n.opt.input&&r.callAllOfObject(n,"inputSetup",n.opt.input)),n.hookDragOn(e),n.hookDropOn(e)},n.hookDragOn=function(e){n.opt.fullDocDragDetect?(n.delegate(document.body,"dragEnter"),r.addEvent(document,"dragleave",(function(e){(0==e.clientX&&0==e.clientY||r.isTag(e.relatedTarget,"html"))&&(r.stopEvent(e),r.callAllOfObject(n,"dragLeave",e))}))):(n.delegate(e,"dragEnter"),n.delegate(e,"dragLeave")),n.delegate(e,"dragOver"),n.delegate(e,"dragEnd"),n.delegate(e,"dragExit")},n.hookDropOn=function(e){r.isIE9||n.delegate(e,"drop","upload")},n.delegate=function(e,t,a){r.addEvent(e,t.toLowerCase(),(function(e){r.stopEvent(e),r.callAllOfObject(n,a||t,e)}))},n.prepareInput=function(e){var t=n.findInputRecursive(e)||n.createInputAt(e);if(t){for(var a=t.parentNode;a&&!r.isTag(a,"form");)a=a.parentNode;if(!a)throw"FileDrop file input has no parent form element.";var o=a?a.getAttribute("target"):"";if(o&&r.isTag(r.byID(o),"iframe"))return{file:t,form:a}}return!1},n.findInputRecursive=function(e){for(var t=0;t<e.childNodes.length;t++){var a=e.childNodes[t];if(r.isTag(a,"input")&&"file"==a.getAttribute("type")&&r.hasClass(a,n.opt.inputClass))return a;if(a=arguments.callee(a))return a}},n.createInputAt=function(e){do{var t=r.randomID()}while(r.byID(t));var a=document.createElement("div");a.innerHTML='<iframe src="javascript:false" name="'+t+'"></iframe><form method="post" enctype="multipart/form-data"><input type="hidden" name="'+n.opt.iframe.callbackParam+'" /><input type="file" name="'+n.opt.iframe.fileParam+'" /></form>',a.firstChild.setAttribute("id",t),a.firstChild.style.display="none",a.lastChild.setAttribute("target",t);for(var o=e.firstChild;o&&(!r.isTag(o)||r.isTag(o,"legend"));)o=o.nextSibling;return o?e.insertBefore(a,o):e.appendChild(a),a.lastChild.lastChild},n.abortIFrame=function(){if(n.opt.input.form){var e=r.byID(n.opt.input.form.getAttribute("target"));e&&e.setAttribute("src","javascript:false")}},n.sendViaIFrame=function(e){e=e||n.opt.iframe.url;var t=(n.opt.input||{}).form;if(e&&t){do{var a=r.randomID()}while(a in window);window[a]=function(t){"object"!=typeof t&&(t={response:t,responseXML:"",responseText:(t||"").toString(),readyState:4,status:200,statusText:"OK",getAllResponseHeaders:function(){return""},getResponseHeader:function(){return""},setRequestHeader:function(){return this},statusCode:function(){return this},abort:function(){return this}}),r.extend(t,{iframe:!0,url:e}),r.callAllOfObject(n,"iframeDone",t)};for(var o=t.firstChild;o&&(!r.isTag(o,"input")||o.name!=n.opt.iframe.callbackParam);)o=o.nextSibling;return o?o.value=a:e=e.replace(/[?&]+$/,"")+(-1==e.indexOf("?")?"?":"&")+n.opt.iframe.callbackParam+"="+a,t.setAttribute("action",e),r.callAllOfObject(n,"iframeSetup",t),t.submit(),setTimeout(n.resetForm,300),!0}},n.resetForm=function(){var e=n.opt.input&&n.opt.input.file;if(e&&(e.value="",n.opt.recreateInput)){var t=n.opt.input.file=e.cloneNode(!0);e.parentNode.replaceChild(t,e),r.callAllOfObject(n,"inputSetup",[n.opt.input,e])}},n.multiple=function(e){return n.opt.input&&void 0!==e&&(e?n.opt.input.file.setAttribute("multiple","multiple"):n.opt.input.file.removeAttribute("multiple")),n.opt.input&&!!n.opt.input.file.getAttribute("multiple")},n.event=function(e,t){return r.appendEventsToObject.apply(n,arguments)},n.preview=function(e,t){return r.previewToObject.apply(n,arguments)},n.onInputSetup=function(t,a){a?(t.file.clearAttributes&&t.file.clearAttributes(),t.file.mergeAttributes&&t.file.mergeAttributes(a)):n.multiple(n.opt.multiple),r.setClass(t.file,n.opt.inputClass),n.delegate(t.file,"change","upload");var o=t.file.parentNode;if(o&&o.style.display.match(/^(static)?$/)&&(o.style.position="relative"),r.isTag(e,"fieldset")){var i=document.createElement("div");i.style.position="relative",i.style.overflow="hidden",e.parentNode.insertBefore(i,e),i.appendChild(e)}},n.onDragOver=function(e){r.stopEvent(e),e.dataTransfer&&(e.dataTransfer.dropEffect=n.opt.dropEffect)},n.onUpload=function(){for(var e=0;e<r.all.length;e++)r.all[e]!==n&&r.all[e].events&&r.callAllOfObject(r.all[e],"uploadElsewhere",n)},n.event({inputSetup:n.onInputSetup,dragOver:n.onDragOver,upload:n.onUpload}),r.setClass(e,n.opt.zoneClass),n.hook(e)},r.FileDrop=function(e,t){function n(t){return function(){r.setClass(e,a.opt.dragOverClass,t)}}var a=this;e=r.byID(e),a.handle=new r.DropHandle(e,t),a.handle.filedrop=a,r.extend(a.handle.opt,{dragOverClass:"over"}),r.extend(a.handle.opt.iframe,{force:!1}),r.extend(a.handle.events,{send:[],fileSetup:[]}),a.onUpload=function(e){var t=!a.opt.iframe.force&&a.eventFiles(e,!0);t?t.length>0&&r.callAllOfObject(a,"send",[t]):!a.handle.sendViaIFrame()&&r.hasConsole&&console.warn("FileDrop fallback upload triggered but iframe options were not configured - doing nothing.")},a.eventFiles=function(e,t){var n=new r.FileList(e);if(e.dataTransfer&&(e.dataTransfer.length||e.dataTransfer.files))var o=e.dataTransfer;else o=e.target&&e.target.files||e.srcElement&&e.srcElement.files;if(o){var i=o.items||[];o.files&&(o=o.files);for(var l={},s=0;s<o.length;s++){var c=new r.File(o[s]);l[c.name]&&"image.jpg"!=c.name||(l[c.name]=!0,c.setNativeEntry(i[s]),r.callAllOfObject(a,"fileSetup",c),(c.size>0||c.nativeEntry)&&n.push(c))}}else t&&(n=!1);return n},r.extend(a,a.handle),a.event({upload:a.onUpload,send:a.resetForm,dragEnter:n(!0),dragLeave:n(!1),uploadElsewhere:n(!1)}),a.preview({upload:n(!1)})},r.FileList=function(e){var t=this;t.dropEffect=e&&e.dropEffect||"",t.length=0,e=null,t.push=function(e){return t[t.length++]=e,t},t.pop=function(){if(t.length>0){var e=t.last();return delete t[--t.length],e}},t.first=function(){return t[0]},t.last=function(){return t[t.length-1]},t.remove=function(e){for(;e<t.length-1;e++)t[e]=t[e+1];return se.f.pop(),t},t.clear=function(){for(var e=0;e<t.length;e++)delete t[e];return t.length=0,t},t.reverse=function(){for(var e=0;e<Math.floor(t.length/2);e++)t[e]=t[t.length-e-1];return t},t.concat=function(e){for(var n=new r.FileList,a=0;a<t.length;a++)n[a]=t[a];for(a=0;e&&a<e.length;a++)n[t.length+a+1]=e[a];return n.length=t.length+(e||[]).length,t},t.sort=function(e,r){for(var n=0;n<t.length;n++)for(var a=0;a<t.length;a++)if(e.call(r||this,t[n],t[a],n,a)<0){var o=t[n];t[n]=t[a],t[a]=o}return t},t.sortBy=function(e,r){for(var n=[],a=0;a<t.length;a++)n.push([a,e.call(r||this,t[a],a)]);n.sort((function(e,t){return e[1]>t[1]?1:e[1]<t[1]?-1:0}));for(a=0;a<n.length;a++)t[a]=n[a][0];return t},t.find=function(e,r){for(var n=0;n<t.length;n++){if(null!=e.call(r||this,t[n],n))return t[n]}},t.each=function(e,r){return t.find((function(){e.apply(this,arguments)}),r),t},t.invoke=function(e,t){var n=r.toArray(arguments,1);return this.each((function(t){t[e].apply(t,n)}))},t.abort=function(){return this.invoke("abort")},t.findCompare=function(e,r){var n;return t.each((function(e){n=e}),r),n},t.filter=function(e,n){var a=new r.FileList;return t.each((function(t){e.apply(this,arguments)&&a.push(t)}),n),a},t.largest=function(){return t.findCompare((function(e){return e.size}))},t.smallest=function(){return t.findCompare((function(e){return-e.size}))},t.oldest=function(){return t.findCompare((function(e){return-e.modDate.getTime()}))},t.newest=function(){return t.findCompare((function(e){return e.modDate}))},t.ofType=function(e){return e+=-1==e.indexOf("/")?"/":"$",e=new RegExp("^"+e,"i"),t.filter((function(t){return e.test(t.type)}))},t.images=function(){return t.ofType("image")},t.named=function(e){return"string"==typeof e?t.find((function(t){return t.name==e})):t.filter((function(t){return e.test(t.name)}))}},r.FileList.prototype.length=0,r.FileList.prototype.splice=Array.prototype.splice,r.File=function(t){var n=this;n.nativeFile=t,n.nativeEntry=null,n.name=t.fileName||t.name||"",n.size=t.fileSize||t.size||0,n.type=n.mime=t.fileType||t.type||"",n.modDate=t.lastModifiedDate||new Date,n.xhr=null,n.opt={extraHeaders:!0,xRequestedWith:!0,method:"POST"},n.events={any:[],xhrSetup:[],xhrSend:[],progress:[],done:[],error:[]},n.events.sendXHR=n.events.xhrSend,n.abort=function(){return n.xhr&&n.xhr.abort&&n.xhr.abort(),n},n.sendTo=function(e,t){if((t=r.extend(t,n.opt)).url=e,n.size)if(window.FileReader){var a=new FileReader;a.onload=function(e){n.sendDataReadyTo(t,e)},a.onerror=function(e){r.callAllOfObject(n,"error",[e])},a.readAsArrayBuffer(n.nativeFile)}else n.sendDataReadyTo(t);else r.hasConsole&&console.warn("Trying to send an empty FileDrop.File.");return n},n.sendDataReadyTo=function(e,t){if(n.abort(),n.xhr=r.newXHR(),n.hookXHR(n.xhr),n.xhr.open(e.method,e.url,!0),n.xhr.overrideMimeType&&n.xhr.overrideMimeType("application/octet-stream"),n.xhr.setRequestHeader("Content-Type","application/octet-stream"),e.extraHeaders){n.xhr.setRequestHeader("X-File-Name",encodeURIComponent(n.name)),n.xhr.setRequestHeader("X-File-Size",n.size),n.xhr.setRequestHeader("X-File-Type",n.type),n.xhr.setRequestHeader("X-File-Date",n.modDate.toGMTString());var a=e.xRequestedWith;if(!0===a)a="FileDrop-XHR-"+(window.FileReader?"FileAPI":"Webkit");a&&n.xhr.setRequestHeader("X-Requested-With",a)}r.callAllOfObject(n,"xhrSetup",[n.xhr,e]);var o=t&&t.target&&t.target.result?t.target.result:n.nativeFile;return r.callAllOfObject(n,"xhrSend",[n.xhr,o,e]),n.xhr},n.hookXHR=function(e){var t=e.upload||e;e.onreadystatechange=function(t){if(4==e.readyState){try{var a=200==e.status?"done":"error"}catch(t){a="error"}var o="error"==a?[t,e]:[e,t];r.callAllOfObject(n,a,o)}},t.onprogress=function(t){var a=t.lengthComputable?t.loaded:null;r.callAllOfObject(n,"progress",[a,t.total||null,e,t])}},n.readData=function(e,t,r){return n.read({onDone:e,onError:t,func:r})},n.readDataURL=function(e,t){return n.readData(e,t||!1,"uri")},n.readDataURI=n.readDataURL,n.read=function(t){function a(e,r){"object"==typeof r||(r.message=r),r.fdError=e,!1!==t.onError&&(t.onError||t.onDone).apply(this,arguments)}if(r.extend(t,{onDone:new Function,onError:null,blob:n.nativeFile,func:"",start:0,end:null,mime:""}),!window.FileReader)return a("support",e);(t.start>0||null!=t.end&&t.end)&&(t.blob.slice?(null==t.end&&(t.end=t.blob.size||t.blob.fileSize),t.blob=t.blob.slice(t.start,t.end,t.mime)):r.hasConsole&&console.warn("File Blob/slice() are unsupported - operating on entire File."));var o=new FileReader;o.onerror=function(e){a("read",e)},o.onload=function(e){e.target&&e.target.result?("readAsBinaryString"==t.func&&(e.target.result=String.fromCharCode.apply(null,new Uint8Array(e.target.result))),t.onDone(e.target.result)):o.onerror(e)};var i=t.func;if(r.isArray(i)){var l=i[0];return i[0]=t.blob,o[l].apply(o,i)}if(i&&"bin"!=i){if("url"==i||"uri"==i||"src"==i)i="readAsDataURL";else if("array"==i)i="readAsArrayBuffer";else if("text"==i)i="readAsText";else if("read"!=i.substr(0,4))return o.readAsText(t.blob,i)}else i="readAsBinaryString";return"readAsBinaryString"==i&&(i="readAsArrayBuffer"),o[i](t.blob)},n.listEntries=function(e,t){if(n.nativeEntry&&n.nativeEntry.isDirectory){t=t||new Function;var a=n.nativeEntry.createReader(),o=new r.FileList,i=0;function l(t){0==(i-=t)&&e&&(e(o),e=null)}return a.readEntries((function(e){for(var n=0;n<e.length;n++){var s=e[n];s.file?(i++,s.file((function(e){var t=new r.File(e);t.setNativeEntry(s),o.push(t),l(1)}),(function(){o.push(r.File.fromEntry(s)),l(1),t.apply(this,arguments)}))):o.push(r.File.fromEntry(s))}n?a.readEntries(arguments.callee,t):l(0)}),t),!0}},n.setNativeEntry=function(e){n.nativeEntry=e&&e.webkitGetAsEntry&&e.webkitGetAsEntry()},n.event=function(e,t){return r.appendEventsToObject.apply(n,arguments)},n.preview=function(e,t){return r.previewToObject.apply(n,arguments)},n.onXhrSend=function(e,t){e.send(t)},n.event({xhrSend:n.onXhrSend})},r.File.fromEntry=function(e){var t=new r.File(e);return t.setNativeEntry(e),t.nativeFile=null,t},r.jQuery=function(e){if(!(e=e||jQuery||window.jQuery))throw"No window.jQuery object to integrate FileDrop into.";e.fn.filedrop=function(t){function n(e,t){return function(n){var o=(t||[]).concat(r.toArray(arguments,1));return a.triggerHandler((e+n).toLowerCase(),o)}}var a=this,o=this.data("filedrop");if("string"==typeof t)if(o){if(void 0!==o[t]){var i=o[t];return"function"==typeof i?i.apply(o,r.toArray(arguments,1)):i}e.error("There's no method or property FileDrop."+t+".")}else e.error("$.filedrop('comment') needs an initialized FilrDrop on this element.");else if(t&&"object"!=typeof t)e.error("Invalid $.filedrop() parameter - expected nothing (creates new zone), a string (property to access) or an object (custom zone options).");else if(o){if(!t)return o;r.extend(o.opt,t,!0)}else{var l=new FileDrop(this[0],t);l.$el=e(this),this.first().data("filedrop",l),l.event("any",n("fd")),l.on.fileSetup.push((function(e){e.event("any",n("file",[e]))}))}return a}},t.FileDrop=r.FileDrop}));